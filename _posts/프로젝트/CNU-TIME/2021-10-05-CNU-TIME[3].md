---

title:  "CNU TIME[3]"
excerpt: "싹 다 갈아없고 게시물, 댓글 CRUD 기능 구현"
date:   2021-10-05 13:28:00 +0900
header:
  teaser: /assets/images/spring.png

categories: CNUTime
tags:
  - Java
  - Spring
  - MVC
  - JPA
  - project
last_modified_at: 2021-10-05T13:28:00-05:00


---

<br/>

<br/>

일단 싹 다 갈아버린 이유는... 너무 계획을 제대로 하지 않고 설계를 했었고...

DTO의 사용법을 잘 몰랐는데, 수업을 들은 후 나의 코드가 완전 잘못되었구나를 깨달았음.

그래서 기존에 있던 것을 고쳐갈까 싶기도 하였지만, 

너무 손볼것이 많아 그냥 새롭게 작성하기로 했다.

<br/>

<br/>

### 오늘 발생했던 문제들

#### 1. 스택 오버플로우

![image-20211005104848136](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005104848136.png)

이 코드에서

![image-20211005104857378](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005104857378.png)

![image-20211005104924570](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005104924570.png)

이렇게 되어 무한루프가 발생했다..

updateContent의 writer.~~ 코드를 지워주면 해결

<br/>

<br/>

### 2. 영속성 컨텍스트의 변경 감지를 생각 못해서 생긴 오류

![image-20211005175136347](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005175136347.png)

이런 코드를 작성했는데, 권한 없는 사용자가 게시물을 바꾸니까 401에러는 뜨는데 게시물이 수정되더라구...

생각해보니까 postService로 가져온 post는 영속성 컨텍스트에서 관리되는데 내용을 바꾸니까 당연히 저장되지...이 바보야 ㅡㅡ

post에 id를 받는 새로운 생성자를 만들어줬다.

![image-20211005175333639](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005175333639.png)

일케 바꿔줌

<br/>

<br/>

## 테스트 케이스 작성

이번에는 테스트 케이스를 열심히 작성해보기로 했다!!!

![image-20211005193004356](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005193004356.png)



![image-20211005195236272](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005195236272.png)

![image-20211005195317737](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20211005195317737.png)