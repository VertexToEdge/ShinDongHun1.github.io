---
title:  "스프링 MVC 공부하기[1]"
excerpt: "WAS와 서블릿 컨테이너"
date:   2021-09-20 03:58:00 +0900
header:
  teaser: /assets/images/spring.png

categories: javaSpring
tags:
  - Java
  - Spring
  - MVC
last_modified_at: 2021-09-20T03:58:00-05:00

---

<br/>

<br/>

💡 내가 듣는 강의 - [스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1)

오늘부터는 이제 스프링 MVC에 대해서 조금씩 공부해볼게여!

아직 스프링 기본기가 확실하게 잡히지는 않았지만.. 살짝 재미두 없구 구래서... 두번이나 그래도 강의 반복했으면 할때 됐자나 ㅠ

<br/>

<br/>

## **💡** 시작

##### 우선 기본 용어부터 좀 잡구갈게용. 아니 이게 사실 예전부터 뭐 웹 애플리케이션은 뭐고, 에플리케이션은 뭐고, 앱은 뭐고, 막 단어가 너무 복잡해서 너무 힘들었는데.. 그래도 공부하면서 조금씩 잡혀가니까 좋더라구요 :D 

##### 아무튼 그래서 일단 단어부터 좀 잡구 갈게용!

<br/>

<br/>

## 💡 웹 서버, 웹 애플리케이션 서버

##### 벌써부터 헷갈리죠?? 전 그랬어요 : (

<br/>

### ✏️ 웹 서버

웹 서버의 특징들을 나열해볼게용!

- HTTP 기반으로 동작
- **정적 리소스** 제공 - 정적 HTML, CSS, JS, 이미지, 영상
- 예) NGINX, APACHE

네 HTTP가 뭔지 모르겠으면.. 나중에 정리해서 링크 달아놓을게용! 우선은 검색해서 조금 공부는 하시고 오는게 조아요 :D<br/>아무튼 이렇게 HTTP 기반으로 동작하며, 정적 리소스를 제공해주는 서버를 웹 서버라 해요!

<br/>

### ✏️ 웹 애플리케이션 서버(WAS - Web Application Server)

얘도 웹 서버랑 비슷한데 기능이 조금 달라요!

- HTTP 기반으로 동작

- ##### 웹 서버의 기능 포함 - 정적 리소스 제공 가능

- ##### <span style="color:orange">프로그램 코드를 실행</span>해서 애플리케이션 로직 실행 가능

  - **동적인 HTML** 생성 가능, **HTTP API(REST API)** 생성 가능
  - 서블릿 , JSP, 스프링 MVC 등이 웹 애플리케이션 서버(WAS)에서 동작

- 예) 톰캣(Tomcat), Jetty, Undertow

웹 서버와의 차이점이 보이시나요???

<br/>

<br/>

### ✏️웹 서버 VS 웹 애플리케이션 서버

##### 웹 서버는 정적 리소스를 제공하고, WAS는 정적 리소스 + <span style="color:orange">애플리케이션 로직</span>까지 실행 가능해요!

근데 사실 두 용어의 경계가 모호하다는데...

웹 서버도 플러그인을 설치해서 프로그램을 실행하는 기능을 포함할 수 있구, <br/>웹 애플리케이션 서버도 웹 서버의 기능을 제공하기에...

구분하기가 참 애매하자나요????

이게 언어마다 구분하는 방법이 다른데, 저희는 자바 공부할거니까!<br/>**자바는 서블릿 컨테이너 기능을 제공하면 WAS라고 합니다!**

좀 어려우시면

#### WAS는 <span style="color:orange">애플리케이션 코드</span>를 실행하는데 더 특화되어있다!

라고 정리하고 넘어갈게용 :D 

<br/>

<br/>

### **💡** 웹 시스템 구성

웹 시스템은 최소한으로 구성하면 **WAS**랑 , **DB** 두개로만 구성할 수 있는데용!

근데 이렇게 구성하게 되면 WAS가 할 일이 너무 많아져요. (애플리케이션 로직도 수행하고, 정적 리소스도 뿌리고 뭐...)

애플리케이션 로직이 당연히 정적 리소스보다 처리하는데 더 비용이 크게 들어가자나요???

근데 정적 리소스가 너무 많아지면 정적 리소스 때문에 애플리케이션 로직의 수행이 어려워질 수가 있겠죠?

그래서 큰 시스템을 구성할 때는

#### ✏️ WEB, WAS, DB

 일반적으로는 요렇게 구성을 해요!

**정적 리소스**는 **Web Server**에서 처리하고, 동적인 **애플리케이션 로직**은 **WAS**에서 처리를 전담하게 하는거죠!

또 이렇게 구성하면 리소스 관리가 편해지는데!

- **정적 리소스가 많이 사용 => Web 서버 증설**
- **애플리케이션 리소스가 많이 사용 => WAS 증설**

글만 읽었는데도 좋아보이져?? :D

<br/>

<br/>

## 💡 서블릿

HTML Form으로 데이터를 전송해 본다고 생각해봐용!<br/>action은 뭐고, method는 post고 뭐 입력받은 값에는 뭐가 있고~~~~<br/>전송 버튼을 누르면 서버에 전달이 가겠죠?<br/>그럼 서버에서는 응답 메세지 생성해서 돌려줄거구!

그럼 이것을 위해서 개발자는 뭘 해야할까요?

- 서버 IP연결 대기하고, 소켓 연결하고

- HTTP 요청 메세지를 파싱해서 읽고

- POST방식인지 GET방식인지, 뭐 이런거 읽고

- Content - Type 확인하고

- HTTP 메시지 바디 내용 파싱

- 저장 프로세스 실행

- ##### <span style="color:orange">비즈니스 로직 실행</span>    - 데이터베이스에 저장 요청

- HTTP 응답 메세시 생성

- IP에 응답 전달, 소켓 종료

(이거 막 외우거나 그러지 마세요 ㅠㅠ 그냥 귀찮겠구나~ 하시면 됨)

이렇게 귀찮은 작업들을 모두!!!!(비즈니스 로직 실행하는거 빼고!)

#### <span style="color:orange">서블릿</span>이 해결해줍니다 :D

<br/>

### 💻 서블릿

![image-20210921183856695](https://raw.githubusercontent.com/ShinDongHun1/image_repo/main/img/image-20210921183856695.png)

- ##### urlPatterns에 들어있는 URL이 호출되면 서블릿 코드가 실행됩니다
- ##### HttpServletRequest => HTTP 요청 정보를 편리하게 사용
- ##### HttpServletResponse => HTTP 응답 정보를 편리하게 사용

이게 바로 서블릿인데! 그냥 우리 편하게 해주는구나! 정도로 하고, 다음 글에서 자세히 공부해볼게용

<br/>

<br/>

### 💡 서블릿 컨테이너

##### 서블릿 객체를 생성, 초기화, 호출, 종료하는 <span style="color:orange">생명주기를 담당</span>하는 컨테이너인데요!

##### 톰캣처럼 <span style="color:orange">서블릿을 지원하는 WAS</span>를 <span style="color:orange">서블릿 컨테이너</span>라고 해요!

다음은 서블릿 컨테이너의 특징입니당.

- ##### 서블릿 객체는 <span style="color:orange">싱글톤</span>으로 관리 => 공유 변수 사용 주의

- ##### JSP도 서블릿으로 변환 되어서 사용

- ##### 동시 요청을 위한 <span style="color:orange">멀티 쓰레드 처리 지원</span>

<br/>

<br/>

## 💡 멀티 쓰레드

##### WAS에서 멀티 쓰레드 처리를 지원해 준다 했자나요!

 멀티 쓰레드에 대해서 간단히 공부해봅시다!

<br/>

### 💡 쓰레드

클라이언트에서 서버에서 요청을 하면,  WAS안에서 servlet을 호출해 주는데여<br/>servlet을 도대체 누가 호출해 줄까여???

##### <span style="color:orange">**쓰레드가 호출**</span>해 주는데요!

쓰레드에 대해서 간단히 정리해보자면!

- ##### 에플리케이션 코드를 하나하나 순차적으로 실행시켜줌, (참고로 프로그램을 실행시키는 것은 프로세스!)
- ##### 자바 메인 메서드를 처음 실행하면 main이라는 이름의 쓰레드가 실행
- ##### 쓰레드가 없다면 자바 애플리케이션 실행이 불가능
- ##### 쓰레드는 한번에 하나의 코드 라인만 수행
- ##### 동시 처리가 필요하면 쓰레드를 추가로 생성

<br/>

<br/>

### ✏️ 멀티 쓰레드

다중 요청이 들어오면은 어떻게 할까요???

##### 요청마다 쓰레드를 생성해주는 방법이 있어요!

- ##### 장점

  - ##### 동시 요청을 처리할 수 있다
  - ##### 리소스(CPU, 메모리)가 허용될 때 까지 처리가능
  - ##### 하나의 쓰레드가 지연되어도, 나머지 쓰레드는 정상 동작

- ##### 단점

  - **고객의 요청이 올 때마다 쓰레드를 생성하면, 응답 속도가 늦어짐**
  - **컨텍스트 스위칭 비용이 발생**
  - **쓰레드 생성에 제한이 없기에, 고객이 요청이 너무 많다면, CPU, 메모리 임계점을 넘어서 서버가 죽을 수 있음**

  

#### 위의 단점들을 해결하기 위해서 대부분의 WAS에서 <span style="color:orange">쓰레드 풀</span>을 사용해요!

쓰레드 풀은 먼지 아실테니까...

툼캣에서는 최대 200개가 기본 설정이고 변경 가능해요!

장점으로는

- ##### 쓰레드를 생성하고 종료하는 비용(CPU)이 절약되고 응답 시간이 빨라짐.
- ##### 생성 가능한 쓰레드의 최대치가 있으므로 너무 많은 요청이 들어와도 기존 요청은 안전하게 처리할 수 있다.

<br/>

<br/>

### ✏️ WAS의 멀티 쓰레드 지원

네 그래서 사실 이게 핵심인데여!!!!!

- #### 멀티 쓰레드에 대한 부분을 WAS가 처리

- #### 개발자가 <span style="color:orange">멀티 쓰레드 관련 코드를 신경쓰지 않아도 됨</span>(???? 와!!!!!!!!  와쓰!!!)

- #### 개발차는 마치 싱글 쓰레드 프로그래밍을 하듯이 편리하게 소스 코드를 개발

- #### 멀티 쓰레드 환경이므로 <span style="color:orange">싱글톤 객체(서블릿, 스프링 빈)는 주의해서 사용</span>

<br/>

<br/>

## 💡 백엔드 개발자는 어디까지 알아야 할까?

이부분은 사실 몰라도 될 거 같긴 한데 저한테는 개인적으로 많은 도움이 됐던 이야기들이라! 적어볼게용!

<br/>

### ✏️리소스 제공 방법

#### 💡 정적 리소스 제공

- ##### 고정된 HTML파일, CSS, JS, 이미지, 영상 등을 제공
- ##### 주로 웹 브라우저에서 요청

<br/>

#### 💡 동적인 HTML 페이지 제공

- ##### 동적으로 필요한 HTML 파일을 생성해서 전달 (JSP, 타임리프 사용)
- ##### 웹 브라우저는 받은 HTML을 해석하면 된다.

<br/>

#### 💡 HTTP API(REST API)

##### 사실 완전히 똑같은 단어는 아닌데, 그냥 요즘은 거의 둘을 동일시하게 부르니까 괄호에 넣어봤어여 :D

- ##### HTML이 아니라 데이터를 전달

- ##### 주로 **JSON** 형식 사용

- ##### 다양한 시스템에서 호출

  - ##### 앱 클라리언트 to 서버
  - ##### 웹 클라이언트 to 서버
  - ##### 서버 to 서버

- ##### 데이터만 주고 받기에 UI 화면이 필요하면 클라이언트가 별도 처리

  - ##### UI 클라이언트 접점
    
    - ##### 앱 클라이언트(**아이폰, 안드로이드, PC앱**) 
    - ##### 웹 클라이언트(**React, Vue.js**) 
    - ##### 웹 브라우저에서 자바스트립트를 통한 HTTP API 호출

<br/>

<br/>

### ✏️서버 사이드 렌더링, 클라이언트 사이드 렌더링

<br/>

#### 💡 SSR - 서버 사이드 렌더링

- ##### HTML 최종 결과를 <span style="color:orange">서버</span>에서 만들어 웹 브라우저에 전달

- ##### 주로 정적인 화면에 사용

- ##### 관련기술 : JSP, 타임리프 -> 백엔드 개발자

<br/>

#### 💡 CSR - 클라이언트 사이드 렌더링

- ##### HTML 결과를 자바스크립드를 사용해 <span style="color:orange">웹 브라우저에서</span>에서 동적으로 생성해서 적용

- ##### 주로 동적인 화면에 사용, 웹 환경을 마치 앱 처럼 필요한 부분부분 변경할 수 있음

- ##### 예)구글 지도, Gmail, 구글 캘린더

- ##### 관련기술 : React, Vue.js -> 웹 프론트엔드 개발자

<br/>

<br/>

## **🧾** 정리

#### ✏️ 웹 애플리케이션 서버(WAS):

#### <span style="color:orange">애플리케이션 코드를 실행하는데 특화</span>되어있다.

<br/>

#### ✏️ 서블릿

#### <span style="color:orange">HTTP 요청 정보와 응답 정보</span>를 개발자가 편리하게 사용할 수 있도록 도와준다.

<br/>

#### ✏️서블릿 컨테이너: 

#### 서블릿 객체를 생성, 초기화, 호출, 종료하는 <span style="color:orange">생명주기를 담당</span>하는 컨테이너, 톰캣처럼 <span style="color:orange">서블릿을 지원하는 WAS</span>를 <span style="color:orange">서블릿 컨테이너</span>라고 부른다.



